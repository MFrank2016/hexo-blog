---
title: 【Mysql】如果在Mysql中插入1000万条数据
date: 2019-06-04 09:37:41
tags:
 - mysql
 - 测试
categorys:
 - 数据库
---

阅读本文大约需要：5分钟，本文口感：冰镇🍉

## 说明

看到这个标题，也许你的第一反应会是：？？？，莫名其妙插一千万条数据干嘛？嫌mysql空间太大？

![](https://i.loli.net/2019/05/18/5cdf6539270f631562.jpg)

莫方，自有妙用。想想看，如果你有一个上亿的项目，emmmm，别误会，我是说有可能会发展到上亿数据的项目，比如活动的领取记录表，虽然每次活动可能只有几万甚至几十万条数据，但是如果这个活动系统中创建的活动很多，一个月的数据增长量也许会达到百万甚至千万级别，一年下来，数据量可能就真上亿了。

对于Mysql数据库来说，当数据量达到千万的量级时，可能就会发生一些变化，比如某些sql可能就会因为没有命中索引而十分缓慢，在一个上千万数据的表中进行非最左前缀模糊匹配时，你就会知道什么叫做绝望。所以初期看起来运行良好的程序，等到数据量增大到一定程度时，就容易变得十分缓慢。所以设计一个比较重要的数据表时，用假数据来跑一跑看sql的执行效率是个不错的选择。

于是便有了本篇的话题，如何往Mysql中插入一千万条数据？
omp-account-service-err.log:[omp-account-service]2019-09-09 00:31:00 669 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":4986742.200,"balance":0.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1565248758000,"creditAmount":5000000.000000,"developerId":452,"developerName":"咪咕数字传媒有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":27,"settlementType":2,"status":2,"unbilledUnsettledAmount":13186.200000,"updatedAt":1567960260000,"version":1474} 变更 {"availableAmount":4986742.200,"balance":0.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1565248758000,"creditAmount":5000000.000000,"developerId":452,"developerName":"咪咕数字传媒有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":27,"settlementType":2,"status":2,"unbilledUnsettledAmount":13198.0000000,"version":1475}
omp-account-service-err.log:[omp-account-service]2019-09-09 09:56:44 853 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":363976.400,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1635885.000000,"updatedAt":1567994193000,"version":71432} 变更 {"availableAmount":363976.400,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1635894.0000000,"version":71433}
omp-account-service-err.log.2019-09-05:[omp-account-service]2019-09-05 20:02:11 835 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:563)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":675334.700,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":222229.714790,"updatedAt":1567684914000,"version":153682} 变更 {"availableAmount":675334.700,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":222229.8025400,"version":153683}
omp-account-service-err.log.2019-09-06:[omp-account-service]2019-09-06 10:57:42 226 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:533)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":659561.600,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1340382.600000,"updatedAt":1567738648000,"version":60094} 变更 {"availableAmount":659561.600,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1340391.6000000,"version":60095}
omp-account-service-err.log.2019-09-06:[omp-account-service]2019-09-06 14:15:59 298 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:533)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":644184.200,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1355751.000000,"updatedAt":1567750550000,"version":60739} 变更 {"availableAmount":644184.200,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1355797.8000000,"version":60740}
omp-account-service-err.log.2019-09-06:[omp-account-service]2019-09-06 16:15:25 181 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":671460.470,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":226089.537840,"updatedAt":1567757702000,"version":157346} 变更 {"availableAmount":671460.470,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":226089.6255900,"version":157347}
omp-account-service-err.log.2019-09-06:[omp-account-service]2019-09-06 16:50:56 268 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":671274.590,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":226274.982840,"updatedAt":1567759820000,"version":157490} 变更 {"availableAmount":671274.590,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":226275.0705900,"version":157491}
omp-account-service-err.log.2019-09-06:[omp-account-service]2019-09-06 21:43:02 865 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":616448.000,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1383440.400000,"updatedAt":1567777362000,"version":61850} 变更 {"availableAmount":616448.000,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1383449.4000000,"version":61851}
omp-account-service-err.log.2019-09-07:[omp-account-service]2019-09-07 08:59:21 708 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":581922.200,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1417957.200000,"updatedAt":1567817948000,"version":63119} 变更 {"availableAmount":581922.200,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1418004.0000000,"version":63120}
omp-account-service-err.log.2019-09-07:[omp-account-service]2019-09-07 09:31:54 513 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":664705.740,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":232796.002590,"updatedAt":1567819910000,"version":160462} 变更 {"availableAmount":664705.740,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":232796.0903400,"version":160463}
omp-account-service-err.log.2019-09-08:[omp-account-service]2019-09-08 00:31:00 611 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":4986925.400,"balance":0.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1565248758000,"creditAmount":5000000.000000,"developerId":452,"developerName":"咪咕数字传媒有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":27,"settlementType":2,"status":2,"unbilledUnsettledAmount":13054.800000,"updatedAt":1567873860000,"version":1459} 变更 {"availableAmount":4986925.400,"balance":0.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1565248758000,"creditAmount":5000000.000000,"developerId":452,"developerName":"咪咕数字传媒有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":27,"settlementType":2,"status":2,"unbilledUnsettledAmount":13066.6000000,"version":1460}
omp-account-service-err.log.2019-09-08:[omp-account-service]2019-09-08 07:17:31 78 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":658959.590,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":238564.393140,"updatedAt":1567898216000,"version":164987} 变更 {"availableAmount":658959.590,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":238571.4131400,"version":164988}
omp-account-service-err.log.2019-09-08:[omp-account-service]2019-09-08 16:40:54 808 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":655959.000,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":241557.506140,"updatedAt":1567932043000,"version":167459} 变更 {"availableAmount":655959.000,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":241557.5938900,"version":167460}

omp-account-service-err.log.2019-09-05:[omp-account-service]2019-09-05 13:08:26 83 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:563)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":676987.190,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":220581.411990,"updatedAt":1567660013000,"version":152018} 变更 {"availableAmount":676987.190,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":220581.4997400,"version":152019}
omp-account-service-err.log.2019-09-05:[omp-account-service]2019-09-05 16:12:27 588 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:563)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":676202.290,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":221364.481390,"updatedAt":1567671144000,"version":152741} 变更 {"availableAmount":676202.290,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":221364.5691400,"version":152742}
omp-account-service-err.log.2019-09-05:[omp-account-service]2019-09-05 22:30:10 408 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:533)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":698155.400,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1301788.800000,"updatedAt":1567693791000,"version":58645} 变更 {"availableAmount":698155.400,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1301835.6000000,"version":58646}
omp-account-service-err.log.2019-09-06:[omp-account-service]2019-09-06 07:36:29 680 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:533)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":673123.280,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":224431.508590,"updatedAt":1567726567000,"version":155447} 变更 {"availableAmount":673123.280,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":224436.7735900,"version":155448}
omp-account-service-err.log.2019-09-07:[omp-account-service]2019-09-07 09:28:32 976 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":664748.230,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":232794.072090,"updatedAt":1567819710000,"version":160442} 变更 {"availableAmount":664748.230,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":232794.1598400,"version":160443}
omp-account-service-err.log.2019-09-08:[omp-account-service]2019-09-08 10:02:43 153 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":657613.040,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":239909.295840,"updatedAt":1567908151000,"version":165611} 变更 {"availableAmount":657613.040,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":239909.4128400,"version":165612}
omp-account-service-err.log.2019-09-08:[omp-account-service]2019-09-08 16:00:50 12 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":656026.760,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":241433.585590,"updatedAt":1567929641000,"version":167253} 变更 {"availableAmount":656026.760,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":241433.7025900,"version":167254}
omp-account-service-err.log.2019-09-08:[omp-account-service]2019-09-08 20:29:35 740 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":654822.900,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":242692.031590,"updatedAt":1567945752000,"version":168475} 变更 {"availableAmount":654822.900,"balance":0.000000,"billedUnsettledAmount":102431.190255,"businessTypeCategoryId":773,"createdAt":1560477620000,"creditAmount":1000000.000000,"developerId":2997,"developerName":"华为软件技术有限公司","earlyWarningAmount":10000.000000,"earlyWarningOn":1,"id":10,"settlementType":2,"status":2,"unbilledUnsettledAmount":242692.1485900,"version":168476}
omp-account-service-err.log.2019-09-08:[omp-account-service]2019-09-08 20:46:27 651 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":416565.200,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1583352.000000,"updatedAt":1567946782000,"version":69312} 变更 {"availableAmount":416565.200,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1583398.8000000,"version":69313}
omp-account-service-err.log.2019-09-08:[omp-account-service]2019-09-08 23:49:58 885 [com.ximalaya.omp.account.service.impl.DeductAccountServiceImpl.increaseUnbillUnsettledAmount(DeductAccountServiceImpl.java:373)]-[ERROR] increaseUnbillUnsettledAmount 失败, 更新前 {"availableAmount":394045.400,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1605825.000000,"updatedAt":1567957785000,"version":70171} 变更 {"availableAmount":394045.400,"balance":2000000.000000,"billedUnsettledAmount":0.000000,"businessTypeCategoryId":0,"createdAt":1561969895000,"creditAmount":0.000000,"developerId":1581,"developerName":"曾俊俊","earlyWarningAmount":300000.000000,"earlyWarningOn":1,"id":15,"settlementType":1,"status":2,"unbilledUnsettledAmount":1605834.0000000,"version":70172}
## 初期准备

Mysql版本为8.0.11：

![](https://i.loli.net/2019/06/05/5cf71abecc5be80960.png)

默认存储引擎为InnoDB：

![](https://i.loli.net/2019/06/05/5cf71e71d75b790847.png)

先创建一个测试用的数据库以及测试用的一张表：

![](https://i.loli.net/2019/06/05/5cf71c9e7335f90543.png)

```sql
create database if not exists test_db default charset utf8 collate utf8_general_ci;
```

上面这句就是创建数据库的命令，`if not exists` 代表如果不存在则创建，如果已存在则不执行。`default charset utf8 collate utf8_general_ci` 则为设置数据库的默认字符集为`utf8`，设置默认的字符比较规则为`utf8_general_ci`。

说到字符集和比较规则，顺便提一句，每种字符集对应若干种比较规则，每种字符集都有默认的比较规则，`utf8_general_ci`是`utf8`的默认比较规则，`_ci`结尾代表这种比较规则不区分大小写。

接下来创建测试用的表：

![](https://i.loli.net/2019/06/10/5cfdb4f13ab8761814.png)

```sql
create table `order_detail` (
    `id` bigint(11) not null auto_increment,
    `order_no` varchar(50) not null comment '订单号',
    `commodity_id` bigint(11) not null comment '商品id',
    `amount` decimal(20,6) not null comment '订单金额',
    `buyer_id` bigint(11) not null comment '付款人id',
    `status` int(2) not null comment '订单状态',
    `created_time` datetime not null comment '创建时间',
    `updated_time` datetime not null comment '更新时间', 
    primary key(`id`)
) engine InnoDB charset utf8mb4 collate utf8mb4_unicode_ci;
```

这里先不加索引，后续会比较有索引和没有索引的情况下，插入数据的效率。

## 暴力插入法

不管是啥，盘它就是了，撸起袖子就是干。新建一个 `springboot` 项目，